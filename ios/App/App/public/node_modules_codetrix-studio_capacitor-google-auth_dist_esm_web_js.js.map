{"version":3,"file":"node_modules_codetrix-studio_capacitor-google-auth_dist_esm_web_js.js","mappings":"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","sources":["./node_modules/@codetrix-studio/capacitor-google-auth/dist/esm/web.js"],"sourcesContent":["import { WebPlugin } from '@capacitor/core';\nexport class GoogleAuthWeb extends WebPlugin {\n    constructor() {\n        super();\n    }\n    loadScript() {\n        if (typeof document === 'undefined') {\n            return;\n        }\n        const scriptId = 'gapi';\n        const scriptEl = document === null || document === void 0 ? void 0 : document.getElementById(scriptId);\n        if (scriptEl) {\n            return;\n        }\n        const head = document.getElementsByTagName('head')[0];\n        const script = document.createElement('script');\n        script.type = 'text/javascript';\n        script.defer = true;\n        script.async = true;\n        script.id = scriptId;\n        script.onload = this.platformJsLoaded.bind(this);\n        script.src = 'https://apis.google.com/js/platform.js';\n        head.appendChild(script);\n    }\n    initialize(_options = {\n        clientId: '',\n        scopes: [],\n        grantOfflineAccess: false,\n    }) {\n        var _a, _b;\n        if (typeof window === 'undefined') {\n            return;\n        }\n        const metaClientId = (_a = document.getElementsByName('google-signin-client_id')[0]) === null || _a === void 0 ? void 0 : _a.content;\n        const clientId = _options.clientId || metaClientId || '';\n        if (!clientId) {\n            console.warn('GoogleAuthPlugin - clientId is empty');\n        }\n        this.options = {\n            clientId,\n            grantOfflineAccess: (_b = _options.grantOfflineAccess) !== null && _b !== void 0 ? _b : false,\n            scopes: _options.scopes || [],\n        };\n        this.gapiLoaded = new Promise((resolve) => {\n            // HACK: Relying on window object, can't get property in gapi.load callback\n            window.gapiResolve = resolve;\n            this.loadScript();\n        });\n        this.addUserChangeListener();\n    }\n    platformJsLoaded() {\n        gapi.load('auth2', () => {\n            const clientConfig = {\n                client_id: this.options.clientId,\n            };\n            if (this.options.scopes.length) {\n                clientConfig.scope = this.options.scopes.join(' ');\n            }\n            gapi.auth2.init(clientConfig);\n            window.gapiResolve();\n        });\n    }\n    async signIn() {\n        return new Promise(async (resolve, reject) => {\n            var _a;\n            try {\n                let serverAuthCode;\n                const needsOfflineAccess = (_a = this.options.grantOfflineAccess) !== null && _a !== void 0 ? _a : false;\n                if (needsOfflineAccess) {\n                    const offlineAccessResponse = await gapi.auth2.getAuthInstance().grantOfflineAccess();\n                    serverAuthCode = offlineAccessResponse.code;\n                }\n                else {\n                    await gapi.auth2.getAuthInstance().signIn();\n                }\n                const googleUser = gapi.auth2.getAuthInstance().currentUser.get();\n                if (needsOfflineAccess) {\n                    // HACK: AuthResponse is null if we don't do this when using grantOfflineAccess\n                    await googleUser.reloadAuthResponse();\n                }\n                const user = this.getUserFrom(googleUser);\n                user.serverAuthCode = serverAuthCode;\n                resolve(user);\n            }\n            catch (error) {\n                reject(error);\n            }\n        });\n    }\n    async refresh() {\n        const authResponse = await gapi.auth2.getAuthInstance().currentUser.get().reloadAuthResponse();\n        return {\n            accessToken: authResponse.access_token,\n            idToken: authResponse.id_token,\n            refreshToken: '',\n        };\n    }\n    async signOut() {\n        return gapi.auth2.getAuthInstance().signOut();\n    }\n    async addUserChangeListener() {\n        await this.gapiLoaded;\n        gapi.auth2.getAuthInstance().currentUser.listen((googleUser) => {\n            this.notifyListeners('userChange', googleUser.isSignedIn() ? this.getUserFrom(googleUser) : null);\n        });\n    }\n    getUserFrom(googleUser) {\n        const user = {};\n        const profile = googleUser.getBasicProfile();\n        user.email = profile.getEmail();\n        user.familyName = profile.getFamilyName();\n        user.givenName = profile.getGivenName();\n        user.id = profile.getId();\n        user.imageUrl = profile.getImageUrl();\n        user.name = profile.getName();\n        const authResponse = googleUser.getAuthResponse(true);\n        user.authentication = {\n            accessToken: authResponse.access_token,\n            idToken: authResponse.id_token,\n            refreshToken: '',\n        };\n        return user;\n    }\n}\n"],"names":["WebPlugin","GoogleAuthWeb","constructor","loadScript","document","scriptId","scriptEl","getElementById","head","getElementsByTagName","script","createElement","type","defer","async","id","onload","platformJsLoaded","bind","src","appendChild","initialize","_options","clientId","scopes","grantOfflineAccess","_a","_b","window","metaClientId","getElementsByName","content","console","warn","options","gapiLoaded","Promise","resolve","gapiResolve","addUserChangeListener","gapi","load","clientConfig","client_id","length","scope","join","auth2","init","signIn","reject","serverAuthCode","needsOfflineAccess","offlineAccessResponse","getAuthInstance","code","googleUser","currentUser","get","reloadAuthResponse","user","getUserFrom","error","refresh","authResponse","accessToken","access_token","idToken","id_token","refreshToken","signOut","listen","notifyListeners","isSignedIn","profile","getBasicProfile","email","getEmail","familyName","getFamilyName","givenName","getGivenName","getId","imageUrl","getImageUrl","name","getName","getAuthResponse","authentication"],"sourceRoot":"webpack:///"}